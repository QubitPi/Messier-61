---
sidebar_position: 2
title: Development
---

https://networkx.org/documentation/latest/developer/index.html


Since we are using Babel 7+, babel config for all packages is in [babel.config.js][babel config should be named
babel.config.js]

Overview
--------

The following guide is intended to help developers who maintain or want to make changes to the Messier-61 framework.

### Building

Messier-61 is written using React with TypeScript. Because Messier-61 is a monorepo with dependencies sparately managed
among modules, it is recommended to fully [build and install][use yarn to install all packages] the project at least 
once:

```bash
cd Messier-61
yarn install
```

:::caution

Messier-61 uses **yarn 2+**, if you happen to have classic yarn installed, [upversion yarn first][yarn upgrade to 2]

:::

Messier-61 uses [yarn workspaces][yarn workspaces] to manage monorepo packages. Whenever we need to run common
operations arcoss all packages, we shall not need to repeat them in each, but simply run a single command at the
project root instead. Therefore, scrips like

```json
"scripts": {
  "install:all": "for package in packages/*/; do yarn --cwd \"${package}\"; done",
  "clean:all": "find . -name node_modules | xargs rm -rf && find . -name yarn.lock -delete",
}
```

are not necessary at all. Worksapce allows multiple projects (in our case, packages) to live together in the same
repository and to cross-reference each other - any modification to one's source code being instantly applied to the
others, which is why **another pitfall of having a manual cross commands like `install:all` is that it results in
runtime linking issues**, such as `Uncaught TypeError: Cannot read properties of null (reading 'useContext')`, if we
don't use [yarn workspaces][yarn workspaces]

_Messier-61 contains at only one workspace: the root itself_.

:::info

The top-level package.json shall not have any dependencies declared. The devDependencies, however, do should contain
ones that are are definitely required by all packages. These are dependencies like Babel and Jest

:::

### Available Scripts

#### Start Messier-61 Locally

```bash
yarn start
```

<!-- markdown-link-check-disable -->
Runs the app in the development mode. Open [http://localhost:8080](http://localhost:8080) to view it in the browser.
<!-- markdown-link-check-enable -->

The page will reload if we make edits. We will also see any lint errors in the console.

#### Running Tests

```bash
yarn test
```

#### Build Production Bundle

```bash
yarn build
```

Builds the app for production to the `build` folder. It correctly bundles React in production mode and optimizes the
build for the best performance. The build is minified and the filenames include the hashes.

### Writing Documentation (TypeDoc)

The [Messier-61 API][API] page was automatically generated by [TypeDoc][TypeDoc], which parses the inline documentation
of Messier-61 source code. To generated them locally

```bash
cd docs
yarn typedoc
```

:::info

TypeDoc processes all source files under `Messier-61/packages/` except for the following

- Test files (`*.test.*`)
- `Messier-61/packages/messier-61-app/messier-61-env.d.ts`
- `Messier-61/packages/messier-61-app/setupTests.ts`

:::

We can have TypeDoc watch for changes from the command line by using

```bash
yarn typedoc-watch
```

Commiting Code
--------------

Before committing your code, please run the following checks locally in order to give ourselves better confidence that
the code will pass the automated checks online:

1. Prettier our code:

   ```bash
   npx prettier --write .
   ```

2. Check code style using ESLint:

   ```bash
   npx eslint .
   ```

   :::caution

   ESLint currently does not run on documentation source codes, i.e. `/docs`

   :::

3. Run all tests

   ```bash
   npm test
   ```

Troubleshooting
---------------

### Docusaurus Relative Linking is Treated False-Negative by CI Markdown Link check

CI check for Markdown link (`markdown-link-check`) is turned on and it's not smart enough to detect relative linking by
Docusaurus. The workaround is to disable the link check at the relevant line. For example:

```markdown
<!-- markdown-link-check-disable -->
known. Additionally, this process makes it easy to implement a [blue-green deployment](continuous-delivery) or
<!-- markdown-link-check-enable -->
```

### ESLint Reports False-Negative

Suppose we have the following TypeScript code

```typescript
node.radius + 25;
```

but ESLint complains that

```bash
error  Operands of '+' operation with any is possible only with string, number, bigint or any  @typescript-eslint/restrict-plus-operands
```

And we are sure that `node.radius` by definition is a `number`. This could happend due to the incorrect import, which
results `node` type not properly imported. As a result, TypeScript sees `node.radius` as to type `any` because it
doesn't know what type `node` is

### Uncaught ReferenceError: React is not defined

happen with `yarn start`

See https://stackoverflow.com/a/64994595

[API]: https://qubitpi.github.io/Messier-61/api/

[babel config should be named babel.config.js]: https://qubitpi.github.io/babel-website/docs/v7-migration/#config-lookup-changes

[onchange]: https://www.npmjs.com/package/onchange

[TypeDoc]: https://qubitpi.github.io/typedoc-site/guides/overview/

[use yarn to install all packages]: https://stackoverflow.com/a/69411230

[yarn upgrade to 2]: https://yarnpkg.com/getting-started/migration#why-should-you-migrate
[yarn workspaces]: https://yarnpkg.com/features/workspaces
